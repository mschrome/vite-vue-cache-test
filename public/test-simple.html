<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>included_files ç®€å•æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .card {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    h1 {
      color: #667eea;
      margin-bottom: 10px;
    }
    
    .info {
      background: #eff6ff;
      border-left: 4px solid #3b82f6;
      padding: 15px;
      border-radius: 5px;
      margin: 15px 0;
    }
    
    .code-block {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      margin: 10px 0;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
    }
    
    .button-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 20px 0;
    }
    
    button {
      padding: 15px 20px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    .result {
      margin-top: 20px;
      padding: 20px;
      border-radius: 8px;
      background: #f8f9fa;
      min-height: 100px;
    }
    
    .success {
      color: #10b981;
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 15px;
    }
    
    .error {
      color: #ef4444;
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 15px;
    }
    
    .loading {
      text-align: center;
      color: #667eea;
      font-size: 16px;
    }
    
    pre {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.5;
      margin: 10px 0;
    }
    
    .detail-item {
      margin: 10px 0;
      padding: 10px;
      background: white;
      border-radius: 5px;
      border: 1px solid #e2e8f0;
    }
    
    .detail-item strong {
      color: #667eea;
      display: block;
      margin-bottom: 5px;
    }
    
    code {
      background: #e2e8f0;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 13px;
      color: #e74c3c;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>ğŸ¯ included_files æç®€æµ‹è¯•</h1>
      <p style="color: #666; margin: 10px 0;">
        æµ‹è¯•æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼šå­—ç¬¦ä¸²ç›¸å¯¹è·¯å¾„ + included_files é…ç½®
      </p>
      
      <div class="info">
        <strong style="display: block; margin-bottom: 10px;">ğŸ’¡ æµ‹è¯•åŸç†ï¼š</strong>
        <p style="margin-bottom: 8px;">1ï¸âƒ£ <code>edgeone.json</code> é…ç½® <code>included_files: ["assets/**"]</code></p>
        <p style="margin-bottom: 8px;">2ï¸âƒ£ ä»£ç ä¸­ç›´æ¥ç”¨å­—ç¬¦ä¸²ï¼š<code>readFileSync('../assets/file.json')</code></p>
        <p>3ï¸âƒ£ EdgeOne Pages è‡ªåŠ¨å¤„ç†æ–‡ä»¶è·¯å¾„</p>
      </div>

      <div class="code-block">// node-functions/test-simple-path.js
import { readFileSync } from 'fs';

export function onRequest() {
  // ğŸ¯ å°±è¿™ä¹ˆç®€å•ï¼
  const filePath = '../assets/config.json';
  const content = readFileSync(filePath, 'utf-8');
  return new Response(content);
}</div>

      <h2 style="color: #667eea; margin-top: 30px; margin-bottom: 15px;">ğŸ“‚ æµ‹è¯•æ–‡ä»¶è¯»å–</h2>
      
      <div class="button-group">
        <button onclick="test('config.json')">ğŸ“„ config.json</button>
        <button onclick="test('data.md')">ğŸ“ data.md</button>
        <button onclick="test('secret.txt')">ğŸ” secret.txt</button>
        <button onclick="test('metadata.json')">ğŸ“‹ metadata.json</button>
      </div>

      <div id="result" class="result" style="display: none;"></div>
    </div>
  </div>

  <script>
    async function test(fileName) {
      const resultDiv = document.getElementById('result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = '<div class="loading">â³ æµ‹è¯•ä¸­...</div>';
      
      try {
        const response = await fetch(`/test-simple-path?file=${fileName}`);
        const data = await response.json();
        
        let html = '';
        
        if (data.success) {
          html += '<div class="success">âœ… æˆåŠŸè¯»å–æ–‡ä»¶ï¼</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ“„ æ–‡ä»¶å</strong>';
          html += `<code>${data.fileName}</code>`;
          html += '</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ“ æ–‡ä»¶è·¯å¾„ï¼ˆä»£ç ä¸­ä½¿ç”¨çš„ï¼‰</strong>';
          html += `<code>${data.filePath}</code>`;
          html += '</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ“‚ process.cwd()</strong>';
          html += `<code>${data.processCwd}</code>`;
          html += '</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ“Š æ–‡ä»¶å¤§å°</strong>';
          html += `${data.fileSize} å­—èŠ‚`;
          html += '</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ“„ æ–‡ä»¶å†…å®¹</strong>';
          html += `<pre>${escapeHtml(data.content.substring(0, 300))}${data.content.length > 300 ? '\n...' : ''}</pre>`;
          html += '</div>';
          
          html += '<div style="background: #d1fae5; padding: 15px; border-radius: 5px; margin-top: 15px;">';
          html += '<strong style="color: #059669;">ğŸ’š ' + data.message + '</strong>';
          html += '</div>';
          
        } else {
          html += '<div class="error">âŒ è¯»å–å¤±è´¥</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>âŒ é”™è¯¯ä¿¡æ¯</strong>';
          html += data.error;
          html += '</div>';
          
          if (data.code) {
            html += '<div class="detail-item">';
            html += '<strong>ğŸ”¢ é”™è¯¯ä»£ç </strong>';
            html += data.code;
            html += '</div>';
          }
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ“‚ process.cwd()</strong>';
          html += `<code>${data.processCwd}</code>`;
          html += '</div>';
          
          html += '<div class="detail-item">';
          html += '<strong>ğŸ” è¯·æ±‚çš„æ–‡ä»¶</strong>';
          html += `<code>${data.requestedFile}</code>`;
          html += '</div>';
          
          html += '<div style="background: #fee2e2; padding: 15px; border-radius: 5px; margin-top: 15px;">';
          html += '<strong style="color: #dc2626;">ğŸ’¡ ' + data.message + '</strong>';
          html += '<p style="margin-top: 10px; font-size: 14px;">è¯·ç¡®ä¿ï¼š</p>';
          html += '<ul style="margin-left: 20px; margin-top: 5px; font-size: 14px;">';
          html += '<li>å·²æ‰§è¡Œ <code>npm run build</code></li>';
          html += '<li><code>dist/assets/</code> ç›®å½•å­˜åœ¨æ–‡ä»¶</li>';
          html += '<li><code>edgeone.json</code> é…ç½®æ­£ç¡®</li>';
          html += '</ul>';
          html += '</div>';
        }
        
        resultDiv.innerHTML = html;
        
      } catch (error) {
        resultDiv.innerHTML = `<div class="error">âŒ è¯·æ±‚å¤±è´¥: ${error.message}</div>`;
      }
    }
    
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
  </script>
</body>
</html>
